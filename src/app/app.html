<div class="workshop-container">
  <!-- Header -->
  <header class="workshop-header">
    <h1>{{ title() }}</h1>
    <p class="subtitle">Interactive GoJs Examples - Builder Pattern API</p>
  </header>

  <!-- Main Content -->
  <div class="workshop-content">

    <!-- Sidebar with Examples -->
    <aside class="examples-sidebar">
      <h2>Examples</h2>
      <nav class="examples-nav">
        @for (example of examples; track example.id) {
          <button
            class="example-btn"
            [class.active]="currentExample() === example.id"
            (click)="selectExample(example.id)">
            {{ example.name }}
          </button>
        }
      </nav>

      <!-- Controls Section -->
      <div class="controls-section">
        <h3>Interactive Controls</h3>
        <div class="controls-grid">
          <button class="control-btn add" (click)="addNode()">
            ‚ûï Add Node
          </button>
          <button class="control-btn remove" (click)="removeSelectedNode()">
            ‚ûñ Remove Selected
          </button>
          <button class="control-btn toggle" (click)="toggleStatus()">
            üîÑ Toggle Status
          </button>
          <button class="control-btn log" (click)="logModelData()">
            üìä Log Model
          </button>
          <button class="control-btn inspect" (click)="logSelectedPart()">
            üîç Inspect Selected
          </button>
        </div>
        <p class="controls-hint">
          üí° Open browser console (F12) to see logged data
        </p>
      </div>
    </aside>

    <!-- Main Diagram Area -->
    <main class="diagram-area">
      <div class="diagram-header">
        <h2>{{ currentExampleName() }}</h2>
      </div>



      <div class="diagram-wrapper">
        <div #diagramDiv class="diagram-canvas"></div>
      </div>

      <!-- Code Explanation -->
      <div class="code-explanation">
        @switch (currentExample()) {
          @case ('mental-model') {
            <div class="explanation">
              <h3>üß† Mental Model: Diagram ‚Üí Model ‚Üí Parts</h3>
              <p><strong>Diagram:</strong> The visual container (the stage where everything happens)</p>
              <p><strong>Model:</strong> Your business data (nodeDataArray, linkDataArray)</p>
              <p><strong>Parts:</strong> Visual representations (Nodes, Links) generated automatically from data</p>
              <div class="key-insight">
                <strong>üí° KEY INSIGHT:</strong> Always modify Model, never Parts directly!
              </div>
              <div class="code-sample">
                <code>
                  // ‚úÖ CORRECT - modify model<br>
                  diagram.model.addNodeData({{ '{' }} key: 4, name: 'Diana' {{ '}' }});<br><br>
                  // ‚ùå WRONG - don't manipulate parts<br>
                  node.position = new go.Point(100, 100); // changes lost!
                </code>
              </div>
            </div>
          }
          @case ('graphobject-basics') {
            <div class="explanation">
              <h3>üî® GraphObject Basics</h3>
              <p><strong>Shape:</strong> Geometric primitive (Rectangle, Circle, RoundedRectangle, etc.)</p>
              <p><strong>TextBlock:</strong> Displays text (editable or read-only)</p>
              <p><strong>Panel:</strong> Container that layouts children</p>
              <div class="key-insight">
                <strong>üí° KEY INSIGHT:</strong> Everything is a GraphObject. Panels contain GraphObjects.
              </div>
              <div class="code-sample">
                <code>
                  // GoJS builder pattern<br>
                  new go.Node('Auto')<br>
                  &nbsp;&nbsp;.add(<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.Shape('RoundedRectangle', {{ '{' }} fill: 'lightblue' {{ '}' }}),<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.TextBlock({{ '{' }} margin: 12 {{ '}' }}).bind('text', 'name')<br>
                  &nbsp;&nbsp;)
                </code>
              </div>
            </div>
          }
          @case ('bindings') {
            <div class="explanation">
              <h3>üîó Bindings: Connecting Data to Visuals</h3>
              <p><strong>Syntax:</strong> .bind('property', 'dataField', conversionFunction)</p>
              <p><strong>Null-safe:</strong> Missing data fields don't crash - property keeps default value</p>
              <p><strong>Pure functions:</strong> No side effects in conversion functions</p>
              <div class="key-insight">
                <strong>üí° KEY INSIGHT:</strong> Bindings are declarative - set once, GoJS maintains sync automatically
              </div>
              <div class="code-sample">
                <code>
                  // Binding with conversion<br>
                  new go.Shape()<br>
                  &nbsp;&nbsp;.bind('fill', 'status', (s) => <br>
                  &nbsp;&nbsp;&nbsp;&nbsp;s === 'active' ? 'green' : 'red'<br>
                  &nbsp;&nbsp;)<br><br>
                  // ‚ùå NO business logic in bindings!<br>
                  // ‚ùå .bind('fill', 'id', id => fetchStatusFromAPI(id))
                </code>
              </div>
            </div>
          }
          @case ('panels-auto') {
            <div class="explanation">
              <h3>üì¶ Panel: Auto</h3>
              <p><strong>Most common for nodes</strong></p>
              <p><strong>Behavior:</strong> First child (usually Shape) automatically sizes to fit other children</p>
              <p><strong>Think:</strong> "Auto-sizing background"</p>
              <div class="key-insight">
                <strong>üí° USE CASE:</strong> When you want a shape to wrap around content perfectly
              </div>
              <div class="code-sample">
                <code>
                  new go.Node('Auto')<br>
                  &nbsp;&nbsp;.add(<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.Shape('Rectangle'), // sizes to fit<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.TextBlock('Content') // determines size<br>
                  &nbsp;&nbsp;)
                </code>
              </div>
            </div>
          }
          @case ('panels-spot') {
            <div class="explanation">
              <h3>üìç Panel: Spot</h3>
              <p><strong>Absolute positioning</strong> using compass points (spots)</p>
              <p><strong>Spots:</strong> Center, Top, TopRight, Right, BottomRight, Bottom, BottomLeft, Left, TopLeft</p>
              <p><strong>Think:</strong> "Main element + positioned decorations"</p>
              <div class="key-insight">
                <strong>üí° USE CASE:</strong> Badges, icons, status indicators on corners
              </div>
              <div class="code-sample">
                <code>
                  new go.Panel('Spot')<br>
                  &nbsp;&nbsp;.add(<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.Shape('Circle'), // main<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.TextBlock('5')<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.set({{ '{' }} alignment: go.Spot.TopRight {{ '}' }}) // badge<br>
                  &nbsp;&nbsp;)
                </code>
              </div>
            </div>
          }
          @case ('panels-vertical') {
            <div class="explanation">
              <h3>üìö Panel: Vertical & Horizontal</h3>
              <p><strong>Vertical:</strong> Stacks children vertically (like CSS flexbox column)</p>
              <p><strong>Horizontal:</strong> Stacks children horizontally (like CSS flexbox row)</p>
              <p><strong>Think:</strong> "Layout manager for lists"</p>
              <div class="key-insight">
                <strong>üí° USE CASE:</strong> Multi-line text, property lists, icon+label combinations
              </div>
              <div class="code-sample">
                <code>
                  new go.Panel('Vertical')<br>
                  &nbsp;&nbsp;.add(<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.TextBlock('Name'),<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.TextBlock('Title'),<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.TextBlock('Email')<br>
                  &nbsp;&nbsp;)
                </code>
              </div>
            </div>
          }
          @case ('composition') {
            <div class="explanation">
              <h3>üé® Composition Pattern</h3>
              <p><strong>Panels compose:</strong> You can nest panels inside panels</p>
              <p><strong>Common pattern:</strong> Auto > Vertical/Horizontal > content</p>
              <p><strong>Think:</strong> "Building blocks - combine for complex layouts"</p>
              <div class="key-insight">
                <strong>üí° PATTERN:</strong> Auto for bg ‚Üí Vertical for stacking ‚Üí Horizontal for rows
              </div>
              <div class="code-sample">
                <code>
                  new go.Node('Auto') // auto-sizing background<br>
                  &nbsp;&nbsp;.add(<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.Shape('RoundedRectangle'),<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;new go.Panel('Vertical') // stack content<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.add(<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new go.TextBlock().bind('text', 'name'),<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new go.Panel('Horizontal') // icon + status<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.add(/* ... */)<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
                  &nbsp;&nbsp;)
                </code>
              </div>
            </div>
          }
          @case ('events') {
            <div class="explanation">
              <h3>‚ö° Events & Interactions</h3>
              <p><strong>Event Categories:</strong></p>
              <ul>
                <li><strong>DiagramEvent:</strong> diagram-level (SelectionChanged, LayoutCompleted)</li>
                <li><strong>ChangedEvent:</strong> model data changes (for undo-redo, sync to backend)</li>
                <li><strong>InputEvent:</strong> user interactions (click, mouseEnter, mouseLeave)</li>
              </ul>
              <div class="key-insight">
                <strong>üí° TRY IT:</strong> Click nodes, hover over them - see console logs & interactions!
              </div>
              <div class="code-sample">
                <code>
                  new go.Node('Auto', {{ '{' }}<br>
                  &nbsp;&nbsp;click: (e, obj) => {{ '{' }}<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;console.log('Clicked:', obj.part.data);<br>
                  &nbsp;&nbsp;{{ '}' }},<br>
                  &nbsp;&nbsp;mouseEnter: (e, obj) => {{ '{' }} /* highlight */ {{ '}' }}<br>
                  {{ '}' }})
                </code>
              </div>
            </div>
          }
        }
      </div>
    </main>
  </div>
</div>
